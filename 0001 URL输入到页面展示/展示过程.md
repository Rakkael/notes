---
title:"0001 url输入到页面展示"
output:pdf_document
---

1、DNS解析（网址->IP地址） https://www.cnblogs.com/qingdaofu/p/7399670.html

```    
DNS缓存：存储于浏览器里，和 hosts
分级查询：本地DNS -> 根域名服务器 -> COM顶级域名服务器 -> google.com域名服务器
其中DNS缓存是递归查询，分级查询是迭代查询

所谓递归查询就是：如果主机所询问的本地域名服务器不知道被查询的域名的IP地址，那么本地域名服务器就以DNS客户的身份，向其它根域名服务器继续发出查询请求报文(即替主机继续查询)，而不是让主机自己进行下一步查询。

（递归的特点：查询的时候换手了，也就是调用了一个新的一模一样的函数去查询。自己调用了自己，新的自己去查询。即，客户端只提出一次查询请求，要求返回最终结果。）
（迭代的特点：每次查询都是我自己这个函数去查询，但是迭代1次没找到，我改进改进再查第二次。重点强调改进的这个过程。即，客户端发起查询请求后，服务器返回一个列表，客户端再次在列表中继续查询，直到找到最终结果。）
（循环的特点：我查询了一次没找到，又查询了一次，直到找到了为止。强调我一直重复在做查询的这件事。）

DNS在解析的过程中可能会被劫持。
```

2、建立TCP连接
```
详解三次握手：（为什么不是2次？无法验证全双工，不可靠。为什么不是4次？提高效率）
1、首先服务端处于监听状态,客户端向服务端发送报文，发起连接请求，其中报文SYN=1，ISN依据当前时间，动态随机生成一个SEQ_A发送给服务端。
2、服务端收到后，进入SYN—RCVD状态，并向A发送SYN=1，ACK=1，ack=SEQ_A+1，SEQ=SEQ_B
3、当A收到B的报文后，A就转换为连接状态了。并且再次向服务端发送报文，包含ACK=1，ack=SEQ_B+1，seq=SEQ_A+1

SYN是什么？
    翻译过来是同步，是报文中的一个数据，建立连接时候使用的握手标志。

ISN代表什么，有什么意义？
    ISN是 初始化序号数，用来定义字节数据的原点。

ISN 是动态随机的，为什么?
    避免攻击者猜测出SEQ，进行攻击。
什么情况下能猜出来？
。。。再补充吧
```
3、发送HTTP请求

4、处理请求，返回HTTP报文

5、渲染页面

| 渲染过程 |
| --- | --- |
| 解析html建立dom树 |
| 解析css构建render树（将CSS代码解析成树形的数据结构，然后结合DOM合并成render树） |
| 布局render树（Layout/reflow），负责各元素尺寸、位置的计算 |
| 绘制render树（paint），绘制页面像素信息 |
| 浏览器会将各层的信息发送给GPU，GPU会将各层合成（composite），显示在屏幕上。 |


6、断开连接( 四次挥手)
  
    1、首先客户端发起关闭请求报文，其中包含FIN=1，ACK=1，ack=u，seq=w，发送完毕后，客户端处于终止等待1
    2、服务端收到客户端的关闭请求后，将转换为关闭等待1，并向客户端发送ACK报文，ACK=1，ack=w+1，seq=u
    3、客户端收到后进入终止等待2状态，不发送任何报文，等待服务端发送FIN报文，FIN=1，ACK=1，ack=w+1，seq=v，因为这段时间内，服务端可能还发送数据了，所以seq从u变成了v.服务端发送完毕后，进入LAST_ACK状态。
    4、客户端收到服务端的FIN报文后，向服务端发送ACK报文，ACK=1，ack=v+1，seq=w+1进入时间等待状态，等待2MSL是报文在网络中的最大生存时间。

    丢失报文怎么办？
        超时重发。
    为什么要等2msl？
        防止客户端最后发送的报文丢包了，还有再次补发的机会。
    为什么报文都是FIN+ACK？
        rcf的规定
    为什么这么规定？
        互联网丢包是家常便饭，为了抓住一切机会告知接收方有没有丢包，方法就是在报文中捎上ACK

